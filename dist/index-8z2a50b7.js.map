{
  "version": 3,
  "sources": ["../../src/pkg.ts", "../../src/api.ts"],
  "sourcesContent": [
    "export interface PackageInfo {\n    name: string;\n    version: string;\n    dependencies: Record<string, string>;\n    devDependencies: Record<string, string>;\n    peerDependencies: Record<string, string>;\n    peerDependenciesMeta?: Record<string, { optional: boolean }>;\n}\n\nexport interface AggregatedDependencies {\n    deps: Record<string, string>;\n    dev: Record<string, string>;\n    opt: Record<string, string>;\n    peer: Record<string, string>;\n}\n\nexport async function getPackageInfo(npmPackageName: string): Promise<AggregatedDependencies> {\n    const url = `https://registry.npmjs.org/${npmPackageName}/latest`;\n    let response: Response;\n    try {\n        response = await fetch(url);\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n    } catch (e) {\n        throw new Error(`Failed to fetch package info for \"${npmPackageName}\": ${e}`);\n    }\n\n    let data: PackageInfo;\n    try {\n        data = await response.json();\n    } catch (e) {\n        throw new Error(`Invalid JSON response for package \"${npmPackageName}\": ${e}`);\n    }\n\n    const {\n        dependencies = {},\n        devDependencies = {},\n        peerDependencies = {},\n        peerDependenciesMeta = {}\n    } = data;\n\n    const opt: Record<string, string> = {};\n    const peer: Record<string, string> = {};\n\n    for (const [pkg, version] of Object.entries(peerDependencies)) {\n        const meta = peerDependenciesMeta[pkg];\n        if (meta && meta.optional === true) {\n            opt[pkg] = version;\n        } else {\n            peer[pkg] = version;\n        }\n    }\n\n    return {\n        deps: dependencies,\n        dev: devDependencies,\n        opt,\n        peer\n    };\n}",
    "import { AggregatedDependencies, getPackageInfo } from \"./pkg\";\n\nconst cachePrefix = \"wxn0brP/graph/\";\nconst ttl = 24 * 60 * 60 * 1000; // 1 day\n\nexport async function getCache<T>(name: string, callback: (...args: any[]) => Promise<T>, ...args: any[]) {\n    const key = cachePrefix + name;\n    if (localStorage.getItem(key)) {\n        const { data, timestamp } = JSON.parse(localStorage.getItem(key)!);\n        if (Date.now() - timestamp < ttl) {\n            return data;\n        } else {\n            localStorage.removeItem(key);\n        }\n    }\n    const data = await callback(...args);\n    localStorage.setItem(key, JSON.stringify({\n        data,\n        timestamp: Date.now()\n    }));\n    return data;\n}\n\nexport async function searchPackages(): Promise<string[]> {\n    const packages = await fetch(\"https://registry.npmjs.com/-/v1/search?text=@wxn0brp&size=100\").then(res => res.json());\n    return packages.objects.map(({ package: pkg }) => pkg.name);\n}\n\nasync function _getInfo(): Promise<{ name: string, info: AggregatedDependencies }[]> {\n    const names = await searchPackages();\n    const infos = await Promise.all(names.map(async name => {\n        const info = await getPackageInfo(name);\n        return { name, info };\n    }));\n    return infos;\n}\n\nexport function clearAllCache() {\n    Object.keys(localStorage)\n        .filter(key => key.startsWith(cachePrefix))\n        .forEach(key => localStorage.removeItem(key));\n}\n\nexport async function getInfo() {\n    return getCache(\"info\", _getInfo);\n}"
  ],
  "mappings": "AAgBA,eAAsB,CAAc,CAAC,EAAyD,CAC1F,IAAM,EAAM,8BAA8B,WACtC,EACJ,GAAI,CAEA,GADA,EAAW,MAAM,MAAM,CAAG,EACtB,CAAC,EAAS,GACV,MAAU,MAAM,uBAAuB,EAAS,QAAQ,EAE9D,MAAO,EAAG,CACR,MAAU,MAAM,qCAAqC,OAAoB,GAAG,EAGhF,IAAI,EACJ,GAAI,CACA,EAAO,MAAM,EAAS,KAAK,EAC7B,MAAO,EAAG,CACR,MAAU,MAAM,sCAAsC,OAAoB,GAAG,EAGjF,IACI,eAAe,CAAC,EAChB,kBAAkB,CAAC,EACnB,mBAAmB,CAAC,EACpB,uBAAuB,CAAC,GACxB,EAEE,EAA8B,CAAC,EAC/B,EAA+B,CAAC,EAEtC,QAAY,EAAK,KAAY,OAAO,QAAQ,CAAgB,EAAG,CAC3D,IAAM,EAAO,EAAqB,GAClC,GAAI,GAAQ,EAAK,WAAa,GAC1B,EAAI,GAAO,EAEX,OAAK,GAAO,EAIpB,MAAO,CACH,KAAM,EACN,IAAK,EACL,MACA,MACJ,ECzDJ,IAAM,EAAc,iBACd,EAAM,SAEZ,eAAsB,CAAW,CAAC,EAAc,KAA6C,EAAa,CACtG,IAAM,EAAM,EAAc,EAC1B,GAAI,aAAa,QAAQ,CAAG,EAAG,CAC3B,IAAQ,OAAM,aAAc,KAAK,MAAM,aAAa,QAAQ,CAAG,CAAE,EACjE,GAAI,KAAK,IAAI,EAAI,EAAY,EACzB,OAAO,EAEP,kBAAa,WAAW,CAAG,EAGnC,IAAM,EAAO,MAAM,EAAS,GAAG,CAAI,EAKnC,OAJA,aAAa,QAAQ,EAAK,KAAK,UAAU,CACrC,OACA,UAAW,KAAK,IAAI,CACxB,CAAC,CAAC,EACK,EAGX,eAAsB,CAAc,EAAsB,CAEtD,OADiB,MAAM,MAAM,+DAA+D,EAAE,KAAK,KAAO,EAAI,KAAK,CAAC,GACpG,QAAQ,IAAI,EAAG,QAAS,KAAU,EAAI,IAAI,EAG9D,eAAe,CAAQ,EAA8D,CACjF,IAAM,EAAQ,MAAM,EAAe,EAKnC,OAJc,MAAM,QAAQ,IAAI,EAAM,IAAI,MAAM,IAAQ,CACpD,IAAM,EAAO,MAAM,EAAe,CAAI,EACtC,MAAO,CAAE,OAAM,MAAK,EACvB,CAAC,EAIC,SAAS,CAAa,EAAG,CAC5B,OAAO,KAAK,YAAY,EACnB,OAAO,KAAO,EAAI,WAAW,CAAW,CAAC,EACzC,QAAQ,KAAO,aAAa,WAAW,CAAG,CAAC,EAGpD,eAAsB,CAAO,EAAG,CAC5B,OAAO,EAAS,OAAQ,CAAQ",
  "debugId": "1FA88C0D238091EB64756E2164756E21",
  "names": []
}